<!Document>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" type="text/css" href="../style/imports.css">
    <link rel="stylesheet" type="text/css" href="../views/layout.css">

    <link rel="stylesheet" type="text/css" href="testnav.css">

    <link rel="stylesheet" type="text/css" href="testcss.css">
</head>
<html>
<body>
    <!-- Header -->
    <div data-include="header"></div>

    <!-- Navigation -->
    <div data-include="navigation"></div>

    <main>
        <section class="cards">
            <div class="card pos-top charizard animated"></div>
            <div class="card pos-center pika animated"></div>
            <div class="card pos-center eevee animated"></div>
            <div class="card pos-center mewtwo animated"></div>
        </section>
    </main>

</body>
</html>
<script src="https://code.jquery.com/jquery-3.6.1.js"></script>
<script src="testnav.js"></script>
<script>
    var pageid = 'Test page';
    $(function () {
        var includes = $('[data-include]')
        $.each(includes, function () {
            var file = '../views/addons/_' + $(this).data('include') + '.html'
            $(this).load(file)
        })
    })
</script>
<script src="https://unpkg.com/@supabase/supabase-js"></script>
<script src="../../API/login.js"></script>
<script>
    var x;
    var $cards = $(".card");
    var $style = $(".hover");

    $cards
        .on("mousemove touchmove", function (e) {
            // normalise touch/mouse
            var pos = [e.offsetX, e.offsetY];
            e.preventDefault();
            if (e.type === "touchmove") {
                pos = [e.touches[0].clientX, e.touches[0].clientY];
            }
            var $card = $(this);
            // math for mouse position
            var l = pos[0];
            var t = pos[1];
            var h = $card.height();
            var w = $card.width();
            var px = Math.abs(Math.floor(100 / w * l) - 100);
            var py = Math.abs(Math.floor(100 / h * t) - 100);
            var pa = (50 - px) + (50 - py);
            // math for gradient / background positions
            var lp = (50 + (px - 50) / 1.5);
            var tp = (50 + (py - 50) / 1.5);
            var px_spark = (50 + (px - 50) / 7);
            var py_spark = (50 + (py - 50) / 7);
            var p_opc = 20 + (Math.abs(pa) * 1.5);
            var ty = ((tp - 50) / 2) * -1;
            var tx = ((lp - 50) / 1.5) * .5;
            // css to apply for active card
            var grad_pos = `background-position: ${lp}% ${tp}%;`
            var sprk_pos = `background-position: ${px_spark}% ${py_spark}%;`
            var opc = `opacity: ${p_opc / 100};`
            var tf = `transform: rotateX(${ty}deg) rotateY(${tx}deg)`
            // need to use a <style> tag for psuedo elements
            var style = `
      .card:hover:before { ${grad_pos} }  /* gradient */
      .card:hover:after { ${sprk_pos} ${opc} }   /* sparkles */ 
    `
            // set / apply css class and style
            $cards.removeClass("active");
            $card.removeClass("animated");
            $card.attr("style", tf);
            $style.html(style);
            if (e.type === "touchmove") {
                return false;
            }
            clearTimeout(x);
        }).on("mouseout touchend touchcancel", function () {
            // remove css, apply custom animation on end
            var $card = $(this);
            $style.html("");
            $card.removeAttr("style");
            x = setTimeout(function () {
                $card.addClass("animated");
            }, 2500);
        });
</script>