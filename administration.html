<!Document>
<head>
    <link rel="stylesheet" type="text/css" href="/styles/imports.css">
    <link rel="stylesheet" type="text/css" href="/views/layout.css">
    <link rel="stylesheet" type="text/css" href="/views/nav.css">
    <link rel="stylesheet" type="text/css" href="/views/admin/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Strixhaven - Administration</title>
    <link rel="icon" href="/assets/strix_logo.png">
</head>
<html>
<body>
    <!-- Header -->
    <div data-include="header"></div>

    <!-- Navigation -->
    <div data-include="navigation"></div>

    <!-- Main -->
    <main>
        <div class="subnav">
            <div class="subnav-content">
                <a href="#lorehold">lorehold</a>
                <a href="#prismari">prismari</a>
                <a href="#silverquill">silverquill</a>
                <a href="#quandrix">quandrix</a>
                <a href="#witherbloom">witherbloom</a>

            </div>
        </div>
        <div id="principle">
            <div class="cubeWrapper">
                <div id="cubes">
                    <div class="cubeP principle">
                        <div class="content">
                            <h1>Jadzi_the_Oracle</h1>
                            <p>
                                The title of Strixhavens Oracle is only granted to the wisest and most accomplished mage in the multiverse. In order to be the Oracle, one must understand the fundamental truths about the nature of magic and the building blocks of the world, know and wield hundreds if not thousands of spells, and possess impeccable judgment and virtue.

                                The title is currently held by Jadzi, an older human woman who graduated from Strixhaven long ago. With her incredible memory, the legends say she has memorized the location of every star arch on the plane.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="schools">

        </div>
    </main>

    <!-- Model -->
    <div class="model" id="card" hidden>
        <div class="closebtn" id="mclose">X</div>
        <div class="Hname" id="AdName"></div>
        <div class="Hprof" id="AdProf"></div>
        <div class="content">
            <div id="leftbox" class="left"></div>
            <div id="rightbox" class="right"></div>
        </div>
    </div>
</body>
</html>

<script src="https://code.jquery.com/jquery-3.6.1.js"></script>
<script src="/javascript/nav.js"></script>
<script>
    var pageid = 'Administration';
    $(function () {
        var includes = $('[data-include]')
        $.each(includes, function () {
            var file = 'views/addons/_' + $(this).data('include') + '.html'
            $(this).load(file)
        })
    })

    $("a").click(function () {
        // Get Selected
        var h = $(this).attr('href');
        var ref = h.split('#');

        // check current classlist
        var CL = document.getElementById(ref[1]).classList;

        if (CL == "hidden") {
            for (var x = 0; x < schools.length; x++) {
                //Close All
                document.getElementById(schools[x]).classList = "hidden";
            }

            // Open Selected
            document.getElementById(ref[1]).classList = "";
            document.getElementById("principle").classList = "hidden";
        } else {
            // Close Focused
            document.getElementById(ref[1]).classList = "hidden";
            // Open Principle
            document.getElementById("principle").classList.remove('hidden');
        }
    });
</script>
<script src="https://unpkg.com/@supabase/supabase-js"></script>
<script>
    var schools = ["lorehold", "prismari", "silverquill", "quandrix", "witherbloom", "principle"];
    const { createClient } = supabase;
    var anon = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBkY2Nhem1uemlwcGJsbnZ2cWRwIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTY2NzczNDkyOCwiZXhwIjoxOTgzMzEwOTI4fQ.79swd9Gvw45ziqMzXrIxPSnQU67K6swiVnSJAzujLqA';
    var url = 'https://pdccazmnzippblnvvqdp.supabase.co';
    const _supabase = createClient(url, anon);

    for (var x = 0; x < schools.length; x++) {
        // Teacher Data
        _supabase.from('_tblTeachers').select('*').eq('teacher_school', schools[x]).order('id', { ascending: true }).then(response => {
            var teachersinschool = response.data;
            if (teachersinschool) {
                for (var y = 0; y < teachersinschool.length; y++) {
                    var teacher = teachersinschool[y];

                    var school = teacher['teacher_school'];
                    var name = teacher['teacher_name'];
                    var role = teacher['teacher_role'];
                    var type = teacher['teacher_type'];
                    var img = teacher['teacher_img'];
                    var desc = teacher['teacher_description'];

                    addElement(school, name, role, type, img, desc);
                    // document.getElementById(name).addEventListener("click", test);
                }
            }
        })
    }
    var t = 0;
    function addElement(schoolname, name, role, type, img, desc) {
        const newSchool = document.createElement("div");
        const newAdmin = document.createElement("div");
        const newDeans = document.createElement("div");
        const newProfs = document.createElement("div");
        const newPersonContainer = document.createElement("div");
        const newPerson = document.createElement("div");
        const newPersonName = document.createElement("h1");
        const newPersonRoll = document.createElement("h2");
        const newPersonDetails = document.createElement("p");
        const newSchoolType = document.createElement("div");

        newPersonContainer.classList = "cube";
        newPersonContainer.id = name;
        newPersonContainer.style.backgroundImage = "url(../assets/teachers/" + img + ")";

        if (!newPersonContainer.style.backgroundImage) {
            console.log(name + " >> " + newPersonContainer.style.backgroundImage);
            console.log("Image Location >> " + img);
        }

        newPersonContainer.style.backgroundPosition = "center top";

        // Create Person
        newPerson.classList = "content";

        newPersonName.innerText = name;
        newPersonRoll.innerText = role + " of " + type;
        newPersonDetails.innerText = desc;

        newPerson.appendChild(newPersonName);
        newPerson.appendChild(newPersonRoll);
        newPerson.appendChild(newPersonDetails);

        newPersonContainer.appendChild(newPerson);

        // Make School
        var school = document.getElementById(schoolname);
        if (!school) {
            // Create School - hidden
            newSchool.id = schoolname;
            newSchool.classList = "hidden";

            // Add Admin
            newAdmin.classList = "cubewrapper";
            newDeans.id = "Deans";
            newDeans.classList = "cubes";
            newProfs.id = "Professers";
            newProfs.classList = "cubes";

            // Assign Deans
            if (role == "Dean") {
                newDeans.appendChild(newPersonContainer);
            } else {
                // School Type
                newSchoolType.id = type;

                newProfs.appendChild(newPersonContainer);
            }

            newAdmin.appendChild(newDeans);
            newAdmin.appendChild(newProfs);
            newSchool.appendChild(newAdmin);
            document.getElementById("schools").appendChild(newSchool);

        } else {
            var deans = school.querySelector(".cubeWrapper").querySelector("#Deans");
            var profs = school.querySelector(".cubeWrapper").querySelector("#Professers");

            if (!type) {
                console.log(name + " >> need to be sorted out");
            }
            if (type) {
                var typename = "#" + type;

                if (typename == "#") {
                    console.log(name + " >> " + type);
                }

                var t2 = profs.querySelector(typename);

                if (!t2) {
                    // Create new professor type
                    newSchoolType.id = type;
                    newSchoolType.classList = "newRow";

                    profs.appendChild(newSchoolType);

                    t2 = profs.querySelector(typename);
                    if (!t2) {
                        console.log(name);
                    }
                }

                // Assign Deans
                if (role == "Dean") {
                    deans.appendChild(newPersonContainer);
                } else {
                    t2.appendChild(newPersonContainer);
                }
            }
        }
    }
</script>
