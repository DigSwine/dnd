<!Document>
<head>
    <link rel="stylesheet" type="text/css" href="/styles/imports.css">
    <link rel="stylesheet" type="text/css" href="/views/layout.css">
    <link rel="stylesheet" type="text/css" href="/views/nav.css">

    <link rel="stylesheet" type="text/css" href="/views/studentView/studentView.css">

    <style>
    </style>
</head>
<html>
<body>
    <!-- Header -->
    <div data-include="header"></div>

    <!-- Logout -->
    <button class="logout" onclick="logout()">Logout</button>

    <!-- BG -->
    <div id="bg1"></div>
    <div id="particleGenerator"></div>

    <!-- Main -->
    <main>
        <div class="container">
            <div class="left">
                <div class="personcontainer">
                    <div class="info" id="info">
                        <div class="lefttopcontainer">
                            <div class="card">
                                <img id="profilepicture" />
                            </div>
                            <form id="profileform" class="profile">
                                <label>Name: <input id="name" placeholder="Name" /></label>
                                <label>Age: <input id="age" placeholder="Age" /></label>
                                <label>Gender: <input id="gender" placeholder="Gender" /></label>
                                <label>Race: <input id="race" placeholder="Race" /></label>
                                <label>Alignment: <input id="alignment" placeholder="Alignment" /></label>
                                <label>Hair Colour: <input id="haircolour" placeholder="Hair Colour" /></label>
                                <label>Eye Colour: <input id="eyecolour" placeholder="Eye Colour" /></label>
                                <label>Height: <input id="height" placeholder="Height" /></label>
                                <label>Weight: <input id="weight" placeholder="Weight" /></label>
                            </form>
                        </div>
                        <div class="personality scrollbar">
                            <div class="personal">
                                <p>Personality Traits:</p>
                                <textarea placeholder="Personality Traits"></textarea>
                            </div>
                            <div class="personal">
                                <p>Ideals:</p>
                                <textarea placeholder="Ideals"></textarea>
                            </div>
                            <div class="personal">
                                <p>Bonds:</p>
                                <textarea placeholder="Bonds"></textarea>
                            </div>
                            <div class="personal">
                                <p>Flaws:</p>
                                <textarea placeholder="Flaws"></textarea>
                            </div>
                            <form id="personality" class="personalityprofile" hidden>
                                <label>Personality Traits: <input id="personalitytraits" placeholder="PERSONALITY TRAITS" /></label>
                                <label>Ideals: <input id="ideals" placeholder="IDEALS" /></label>
                                <label>Bonds: <input id="bonds" placeholder="BONDS" /></label>
                                <label>Flaws: <input id="flaws" placeholder="FLAWS" /></label>
                            </form>
                        </div>
                    </div>
                    <div class="story" id="story">
                        <div class="backstory">
                            <h1>Backstory</h1>
                            <textarea class="test"></textarea>
                        </div>
                        <div class="extrainfo">
                            <h1>Extra Notes</h1>
                            <textarea class="test"></textarea>
                        </div>                        
                    </div>
                </div>
                <div class="controls">
                    <div class="control" id="profile"><p>Profile</p></div>
                    <div class="control" id="details"><p>Details</p></div>
                </div>
            </div>

            <div class="right">
                <div class="controls">
                    <div class="control" id="one"><p>Course Listings</p></div>
                    <div class="control" id="two"><p>Exam Report Card</p></div>
                    <div class="control" id="three"><p>Relationships</p></div>
                    <div class="control" id="four"><p>Extracurriculas</p></div>
                </div>
                <div class="mainslider" id="mainslider">
                    <div class="slide" id="S1">
                        <h1 class="slideTitle"> Courses </h1>
                        <div class="subnav">
                            <div id="one" class="sub">First Years</div>
                            <div id="two" class="sub">Second Years</div>
                            <div id="three" class="sub">Thrid Years</div>
                            <div id="four" class="sub">Fourth Years</div>
                        </div>
                        <div id="yrCLASSESone" class="yr one">
                            <h2>Enrolled in</h2>
                            <table id="enrolledCLASSES">
                                <tr>
                                    <th>Class Title</th>
                                    <th>Teacher Name</th>
                                    <th>Teacher Image</th>
                                </tr>
                                <tr>
                                    <td>Class 1</td>
                                    <td>Jeff Dunham</td>
                                    <td><img src="assets/eliza.jpg" /></td>
                                </tr>
                            </table>

                        </div>
                        <div id="yrCLASSEStwo" class="yr two" hidden>

                        </div>
                        <div id="yrCLASSESthree" class="yr three" hidden>

                        </div>
                        <div id="yrCLASSESfour" class="yr four" hidden>

                        </div>
                    </div>
                    <div class="slide">
                        <h1 class="slideTitle"> Page 2 </h1>
                    </div>
                    <div class="slide" style="background-color: antiquewhite">
                        <h1 class="slideTitle"> Relationships </h1>
                        <div class="relation">
                            <img src="assets/eliza.jpg" />
                            <p class="name">Eliza</p>
                            <p class="name">Archenemy</p>
                        </div>
                    </div>
                    <div class="slide">
                        <div id="currentJob">
  
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</body>
</html>

<script src="https://code.jquery.com/jquery-3.6.1.js"></script>
<script src="https://unpkg.com/@supabase/supabase-js"></script>
<script>
    var pageid = 'Loading';
    $(function () {
        var includes = $('[data-include]')
        $.each(includes, function () {
            var file = 'views/addons/_' + $(this).data('include') + '.html'
            $(this).load(file)
        }) 
    })

    $('.left .control').click(function () {
        if (this.id == "details") {
            document.getElementById("info").style.opacity = 0;
            setTimeout(() => {
                document.getElementById("info").style.display = "none";
                document.getElementById("story").style.display = "block";
                document.getElementById("story").style.opacity = 1;
            }, 500);
        } else {
            document.getElementById("story").style.opacity = 0;
            setTimeout(() => {
                document.getElementById("story").style.display = "none";
                document.getElementById("info").style.display = "block";
                document.getElementById("info").style.opacity = 1;
            }, 500);
        }
    });

    $('.sub').click(function () {
        document.getElementById('yrCLASSESone').setAttribute('hidden', true);
        document.getElementById('yrCLASSEStwo').setAttribute('hidden', true);
        document.getElementById('yrCLASSESthree').setAttribute('hidden', true);
        document.getElementById('yrCLASSESfour').setAttribute('hidden', true);
        document.getElementById('yrCLASSES' + this.id).removeAttribute('hidden');
    })

    var showing = 0;
    $('.right .control').click(function () {
        var MS = document.getElementById('mainslider');
        showing = toshow(this.id);
        var distance = "-" + $("#S1").width() * showing + "px";
        MS.style.transform = "translateX(" + distance + ")";
    });
    function toshow(id) {
        var send = 0;
        if (id == "one") {
            send = 0;
        }
        if (id == "two") {
            send = 1;
        }
        if (id == "three") {
            send = 2;
        }
        if (id == "four") {
            send = 3;
        }
        return send;
    }
</script>
<script src="../../API/api.js"></script>
<script src="/javascript/login.js"></script>
<script>
    $(document).ready(function () {
        var data = JSON.parse(sessionStorage.getItem("Student_Id"));
        if (data) {
            getStudentDataByID(data);
        }
    })
    function logout() {
        sessionStorage.clear();
        window.location = 'login.html';
    }

    function getStudentDataByID(sid) {
        /* Student Data */
        _supabase.from('_tblStudents').select('*').eq('id', sid).order('id', { ascending: true }).then(response => {
            for (var x = 0; x < response.data.length; x++) {
                var student = response.data[x];
                var alignment = student['Alignment'];
                var eyes = student['Eye Colour'];
                var hair = student['Hair Colour'];
                var height = student['Height'];
                var img = student['Profile Picture'];
                var weight = student['Weight'];
                var age = student['character_age'];
                var gender = student['character_gender'];
                var name = student['character_name'];
                var race = student['character_race'];

                var info = document.getElementById('info');
                info.querySelector('#profilepicture').src = "assets/students/players/" + img;

                info.querySelector('#name').value = name;
                info.querySelector('#age').value = age;
                info.querySelector('#gender').value = gender;
                info.querySelector('#race').value = race;
                info.querySelector('#alignment').value = alignment;
                info.querySelector('#haircolour').value = hair;
                info.querySelector('#eyecolour').value = eyes;
                info.querySelector('#height').value = height;
                info.querySelector('#weight').value = weight;

                document.getElementById('pagename').innerText = "Welcome " + name + "!";
            }
        })
        _supabase.from('Job<>Student').select('Job (id, Title, Location, Pay)').eq('Student', sid).then(response => {
            if (response.data.length > 0) {
                for (var x = 0; x < response.data.length; x++) {
                    var data = response.data[x];
                    var job = data['Job'];

                    var currentJob = document.getElementById('currentJob');

                    const theJob = document.createElement('div');
                    const theJobDetails = document.createElement('div');
                    const theTitle = document.createElement('h3');
                    const theLocation = document.createElement('p');
                    const theWage = document.createElement('p');
                    const QuitButton = document.createElement('button');

                    theJob.classList = "myjob";
                    theJob.id = "myjob";
                    QuitButton.classList = "quit";
                    QuitButton.id = job['id'];
                    QuitButton.innerText = "resign";

                    theTitle.innerText = job['Title'];

                    theJobDetails.classList = "jobdetails";

                    theLocation.innerText = job['Location'];
                    theWage.innerText = job['Pay'];

                    theJobDetails.appendChild(theLocation);
                    theJobDetails.appendChild(theWage);
                    theJobDetails.appendChild(QuitButton);


                    theJob.appendChild(theTitle);
                    theJob.appendChild(theJobDetails);
                    currentJob.appendChild(theJob);

                    document.getElementById(job['id']).addEventListener('click', quitJob, false);
                }
            }
        })
    }
    function quitJob() {
        var sid = JSON.parse(sessionStorage.getItem("Student_Id"));
        var jid = this.id;
        _supabase.from('Job<>Student').delete().eq('Student', sid).then(response => {
        })
        _supabase.from('_tblJobs').update({ 'Player Filled': 'No' }).eq('id', jid).then(response => {
        })
        alert("You have now resigned");
        document.getElementById('myjob').style.display = "none";
    }

var x;
var $cards = $(".card");
var $style = $(".hover");

$cards
  .on("mousemove touchmove", function(e) { 
    // normalise touch/mouse
    e.preventDefault();
    var $card = $(this);
    var h = $card.height();
    var w = $card.width();
    var px = Math.abs(Math.floor(100 / w * 0)-100);
    var py = Math.abs(Math.floor(100 / h * 0)-100);
    var pa = (50-px)+(50-py);
    // set / apply css class and style
    $cards.removeClass("active");
    $card.removeClass("animated");
    if ( e.type === "touchmove" ) {
      return false; 
    }
    clearTimeout(x);
  }).on("mouseout touchend touchcancel", function() {
    // remove css, apply custom animation on end
    var $card = $(this);
    $style.html("");
    x = setTimeout(function() {
      $card.addClass("animated");
    },1000);
  });
</script>